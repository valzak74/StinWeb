#pragma checksum "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "41138838534e13fe2dfaf92b2237f503a828bd68"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Отчеты_Журнал), @"mvc.1.0.view", @"/Views/Отчеты/Журнал.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\_ViewImports.cshtml"
using StinWeb;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\_ViewImports.cshtml"
using NonFactors.Mvc.Grid;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\_ViewImports.cshtml"
using NonFactors.Mvc.Lookup;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\_ViewImports.cshtml"
using StinWeb.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml"
using System.Security.Claims;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"41138838534e13fe2dfaf92b2237f503a828bd68", @"/Views/Отчеты/Журнал.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"303b915066d1efa5c78241ff8833664880cca93b", @"/Views/_ViewImports.cshtml")]
    public class Views_Отчеты_Журнал : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            WriteLiteral("\r\n");
#nullable restore
#line 3 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml"
  
    ViewBag.Title = "Журнал \"Общий\"";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
<div class=""card border-round"" style=""background-color: lightgray;"">
    <div class=""card-header"">
        <div class=""input-group input-group-sm"">
            <div class=""input-group-prepend"">
                <span class=""input-group-text"">Период</span>
            </div>
            <div id=""reportrange"" style=""background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc;"">
                <i class=""fa fa-calendar""></i>&nbsp;
                <span></span> <i class=""fa fa-caret-down""></i>
            </div>
        </div>

    </div>
    <div class=""card-body"">
        <button type=""button"" class=""btn btn-success"" onclick=""ModalДокумент(false, undefined, 9899)"">
            <i class=""fa fa-wrench fa-lg""></i> Прием в ремонт
        </button>
");
#nullable restore
#line 24 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml"
         if ((new[] { "Любой", "Претензионный" }).Contains(User.FindFirstValue("Отдел"), StringComparer.OrdinalIgnoreCase))
        {

#line default
#line hidden
#nullable disable
            WriteLiteral(@"            <button type=""button"" class=""btn btn-success"" onclick=""ModalДокумент(false, undefined, 9899, undefined, undefined, 'ПРЕТЕНЗИЯ')"">
                <i class=""fa fa-wrench fa-lg""></i> Регистрация Претензии
            </button>
            <button type=""button"" class=""btn btn-success"" onclick=""ModalДокумент(false, undefined, 13737)"">
                <i class=""fa fa-bars fa-lg""></i> Изменение статуса
            </button>
");
#nullable restore
#line 32 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml"
        }

#line default
#line hidden
#nullable disable
            WriteLiteral(@"        <button type=""button"" class=""btn btn-success"" onclick=""ModalДокумент(false, undefined, 10080)"">
            <i class=""fa fa-truck fa-lg""></i> Перемещение изделий
        </button>
    </div>
</div>

<ul id=""div-popover"" style=""display:none"">
    ");
#nullable restore
#line 40 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml"
Write(Html.Hidden("popoverIdDoc", ""));

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n    ");
#nullable restore
#line 41 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml"
Write(Html.Hidden("popoverВидДок10", "", new { id = "popoverВидДок10" }));

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n    <li><a id=\"опцияПросмотр\" href=\"#\">Просмотр документа</a></li>\r\n    <li><a id=\"опцияСтруктураПодчиненности\" href=\"#\">Структура подчиненности</a></li>\r\n    <li><a id=\"опцияВводНаОсновании\" href=\"#\">Ввести на основании</a></li>\r\n</ul>\r\n\r\n");
#nullable restore
#line 48 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml"
Write(Html.AjaxGrid(Url.Action("ПолучитьЖурнал", "ЖурналОбщий")));

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n<div id=\"docContent\"></div>\r\n");
#nullable restore
#line 50 "C:\Users\Валентин\source\repos\StinWeb\StinWeb\Views\Отчеты\Журнал.cshtml"
Write(await Component.InvokeAsync("СтруктураПодчиненности"));

#line default
#line hidden
#nullable disable
            WriteLiteral(@"

<script>
    var insidePopover = false;

    function attachEvents(tr) {
        $('.popover').on('mouseenter', function () {
            insidePopover = true;
        });
        $('.popover').on('mouseleave', function () {
            insidePopover = false;
            $(tr).popover('hide');
        });
    }

    $(document).on('mouseleave', 'tr', function () {
        $(this).find('td').each(function () {
            var popoverId = $(this).attr('aria-describedby');
            if (popoverId != undefined && popoverId.startsWith('popover')) {
                var td = $(this);
                setTimeout(function () {
                    if (!insidePopover) td.popover('hide');
                }, 200);
            }
        });
    });
    function TablePopover(element, idDoc, видДок10) {
        if ($(element).attr('havePopover') != 'true') {
            $(element).attr('havePopover', 'true');
            $(element).popover({
                html: true,
                trigge");
            WriteLiteral(@"r: ""manual"",
                placement: ""bottom"",
                container: element,
                content: function () {
                    $(""#popoverIdDoc"").val(idDoc);
                    $(""#popoverВидДок10"").val(видДок10);
                    return $(""#div-popover"").html();
                }
            });
            $(element).on('shown.bs.popover', function () {
                $('#опцияПросмотр').click(function () {
                    $(element).popover('hide');
                    ModalДокумент(true, $(""#popoverIdDoc"").val(), $(""#popoverВидДок10"").val());
                });
                $('#опцияСтруктураПодчиненности').click(function () {
                    $(element).popover('hide');
                    СтруктураПодчиненности($(""#popoverIdDoc"").val());
                });
                $('#опцияВводНаОсновании').click(function () {
                    $(element).popover('hide');
                    ModalДокумент(false, undefined, $(""#popoverВидДок10"").val(), $(""#");
            WriteLiteral(@"popoverIdDoc"").val(), $(""#popoverВидДок10"").val());
                });
            });
            $(element).on('hidden.bs.popover', function () {
                insidePopover = false;
            });
        }
        setTimeout(function () {
            if (!insidePopover) {
                $(element).popover('show');
                attachEvents(element);
            }
        }, 200);
    }

    $(function () {

        var start = moment();
        var end = moment();

        function cb(start, end) {
            $('#reportrange span').html(start.format('DD.MM.YYYY') + ' - ' + end.format('DD.MM.YYYY'));
        }

        $('#reportrange').daterangepicker({
            ""showDropdowns"": true,
            ""locale"": {
                ""format"": ""DD.MM.YYYY"",
                ""separator"": "" - "",
                ""applyLabel"": ""Выбрать"",
                ""cancelLabel"": ""Отмена"",
                ""fromLabel"": ""от"",
                ""toLabel"": ""до"",
                ""customRangeLab");
            WriteLiteral(@"el"": ""Произвольный"",
                ""weekLabel"": ""W"",
                ""daysOfWeek"": [
                    ""Вс"",
                    ""Пн"",
                    ""Вт"",
                    ""Ср"",
                    ""Чт"",
                    ""Пт"",
                    ""Сб""
                ],
                ""monthNames"": [
                    ""Январь"",
                    ""Февраль"",
                    ""Март"",
                    ""Апрель"",
                    ""Май"",
                    ""Июнь"",
                    ""Июль"",
                    ""Август"",
                    ""Сентябрь"",
                    ""Октябрь"",
                    ""Ноябрь"",
                    ""Декабрь""
                ],
                ""firstDay"": 1
            },
            startDate: start,
            endDate: end,
            ranges: {
                'Текущая дата': [moment(), moment()],
                'Текущая неделя': [moment().startOf('week').add(1, 'days'), moment()],
                'Текущий месяц': [m");
            WriteLiteral(@"oment().startOf('month'), moment()],
                'Прошлый месяц': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
            }
        }, cb);

        cb(start, end);

    });
    $(function () {
        setInterval(function () {
            if (!$('body').find('.modal.show').length && !$('body').find('.popover.show').length) {
                const gridЖурнал = new MvcGrid(document.querySelector(""div[data-name='gridЖурналОбщий']""));
                gridЖурнал.reload();
            }
        }, refreshTimeout);
    });
    $('#reportrange').on('apply.daterangepicker', function (ev, picker) {
        const gridЖурнал = new MvcGrid(document.querySelector(""div[data-name='gridЖурналОбщий']""));
        gridЖурнал.set({
            isAjax: true,
            url: ""ЖурналОбщий/ПолучитьЖурнал"",
            query: ""startDate="" + DateTimeToLocalISOString(picker.startDate)
                + ""&endDate="" + DateTimeToLocalISOString(picker.endDate)
 ");
            WriteLiteral(@"       });
        gridЖурнал.reload();
    });

    document.addEventListener(""rowdblclick"", e => {
        if (e.detail.grid.name == ""gridЖурналОбщий"") {
            ModalДокумент(true, e.detail.data[""IdDoc""], e.detail.data[""ВидДокумента10""]);
        }
    });
    document.addEventListener(""rowrightclick"", e => {
        if (e.detail.grid.name == ""gridЖурналОбщий"") {
            TablePopover(e.detail.originalEvent.target, e.detail.data[""IdDoc""], e.detail.data[""ВидДокумента10""]);
        }
    });

    function ModalДокумент(option, idDoc, видДок10, основаниеIdDoc, основаниеВидДок10, параметр) {
        EnableBusyScreen()
        $.ajax({
            url: ""ПолучитьФормуДокумента"",
            type: ""post"",
            datatype: ""xml"",
            data: {
                родитель: ""gridЖурналОбщий"",
                idDoc: idDoc,
                видДок: видДок10,
                просмотр: option,
                докОснованиеId: основаниеIdDoc,
                видДокОснование: основа");
            WriteLiteral(@"ниеВидДок10,
                параметр: параметр
            },
            async: true,
            cache: false,
            success: function (obj) {
                if (obj) {  // check if data is defined
                    $(""#docContent"").html(obj);
                    $(""#выбДокумент"").modal(""show"");
                }
                DisableBusyScreen();
            },
            error: function (e, v, f) {
                alert(""ошибка выполнения!"");
            }
        });
    }
    function СтруктураПодчиненности(el) {
        if (el == undefined) 
            $(""#структураПодчиненностиIdDoc"").val($(""#idDoc"").val());
        else
            $(""#структураПодчиненностиIdDoc"").val(el);
        $('#структураПодчиненности').modal(""show"");
    }
</script>");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
